{% extends 'base.html' %}
{% load static %} 
{% block title %}Starting Page{% endblock %}
{% block content %}
<style>
    .starting-page-container1 {

        width: 80%;
        background: rgba(255, 255, 255, 0.8);
        border-radius: 15px;
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        backdrop-filter: blur(8.5px);
        border: 1px solid rgba(255, 255, 255, 0.18);
        padding: 20px;
        margin: 20px auto;
        text-align: center;
        display: flex;
        flex-wrap: wrap; 
        align-items: center;
        
    }
    .container {
    padding: 2px 16px;
  }
  .starting-page-container1:hover{
    box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
  }
  .description {
    font-family: "Kalam", cursive;
    font-size: 18px; 

  }
    .starting-page-container {
        width: 80%;
        background: rgba(255, 255, 255, 0.8);
        border-radius: 15px;
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        backdrop-filter: blur(8.5px);
        border: 1px solid rgba(255, 255, 255, 0.18);
        padding: 20px;
        margin: auto;
        margin-top: 10px;
        text-align: center;
        display: flex;
        flex-wrap: wrap; 
        justify-content: space-around; 
        align-items: center;
    
    }
    .services-container {
        width: 80%;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        border: 1px solid rgba(255, 255, 255, 0.18);
        padding: 20px;
        z-index: 1; 
        margin: 20px auto;
        text-align: center;
    }

    .input-section {
        margin: 10px; 
        display: flex;
        align-items: center;
    }

    .input-section h2 {
        margin-right: 10px; 
        font-size: 18px; 
        color: #000;
        text-shadow: 1px 1px 3px rgba(0,0,0,0.4); 
    }

    #city-search, #date-input {
        padding: 10px;
        border-radius: 20px;
        border: 1px solid #ced4da;
        background-color: rgba(255,255,255,0.7);
        margin-right: 10px; 
    }

    #city-results {
        position: absolute;
        width: 217px;
        top: 76px;
        left: 173px;
        right: 0;
        background: white;
        border: 1px solid #ddd;
        border-top: none;
        border-radius: 5px;
        list-style: none;
        padding-left: 0;
        max-height: 150px;
        overflow-y: auto;
        z-index: 100;
    }

    #city-results li {
        padding: 10px;
        cursor: pointer;
    }

    #city-results li:hover {
        background-color: #f2f2f2;
    }

    #submit-btn {
        padding: 10px 20px;
        background-color: #007bff;
        color: white;
        border-radius: 20px;
        border: none;
        box-shadow: 0 2px 4px rgba(0, 123, 255, 0.4);
    }

    #submit-btn:hover {
        background-color: #0056b3;
        cursor: pointer;
    }
    .background-layer {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: center;
        transition: opacity 1s ease-in-out;
        z-index: -1;
    }
    

    .input-section {
        margin: 10px;
        display: flex;
        align-items: center;
    }

    .input-section h2, .services-container h2 {
        margin-right: 10px;
        font-size: 18px;
        color: #000;
    }

    #city-search, #date-input, #submit-btn {
        padding: 10px;
        margin-top: 0px;
        border-radius: 20px;
        border: none;
    }

    #submit-btn {
        background-color: #007bff;
        color: white;
        box-shadow: 0 2px 4px rgba(0, 123, 255, 0.4);
        width: 150px;
    }

    #submit-btn:hover {
        background-color: #0056b3;
    }
    .services-container h2{
        font-size: 35px;
        font-family: Georgia, 'Times New Roman', Times, serif;
        font-weight: bold;
    }

    .service-icon {
        transition: transform 0.3s ease;
        color: grey;
    }
    .service-icon i{
        font-size: 40px;
        color: orange;
    }

    .service-icon:hover {
        transform: scale(1.1);
    }

    .services-container {
        padding-top: 30px;
        align-items: center;
    }
    a{
        text-decoration: none;
    }
    .service-item {
        margin: 20px;
        display: inline-block;
    }
    .service-item p {
        text-shadow: 1px 1px 3px rgba(0,0,0,0.4); 
        text-decoration: none;  
    }
    .service-item img {
        height: 200px;
        width: 200px;
        transition: transform 0.3s ease;
    }

    .service-item img:hover {
        transform: scale(1.05);
    }
    .fa-10x{
    margin-bottom: 20px;
    color: #FF5733;
    /* color: #000; */
    }
    .animated-text {
  display: inline-block; 
  font-size: 24px; 
  transition: transform 0.5s ease-in-out; 
  animation: pulse 2s infinite;
}
.starting-page-container {
    display: flex;
    justify-content: center;
    align-items: center;
    /* height: 100vh; Or the height you prefer */
    background-size: cover;
}

.search-container {
    display: flex;
    background: rgba(255, 255, 255, 0.9);
    padding: 20px;
    border-radius: 25px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    width: -webkit-fill-available;
}

.input-section {
    position: relative;
    margin-right: 10px; /* Space between inputs */
}

.search-field {
    border: none;
    padding: 10px 20px;
    border-radius: 20px;
    margin-bottom: 5px; /* Space for the label */
}

.search-label {
    position: absolute;
    top: 100%;
    left: 20px;
    font-size: 10px;
    color: red;
    background: white;
    padding: 0 5px;
}

.destination .search-field,
.date-range .search-field {
    width: 200px; /* Adjust width as needed */
}

#find-hotel-btn {
    padding: 10px 20px;
    border: none;
    border-radius: 20px;
    background-color: black;
    color: white;
    cursor: pointer;
    font-size: 16px;
    transition: background-color 0.3s ease;
}

#find-hotel-btn:hover {
    background-color: #333;
}


/* Responsive Adjustments */
@media (max-width: 768px) {
    .search-container {
        flex-direction: column;
    }
    .input-section {
        margin-right: 0;
        margin-bottom: 10px; /* Space between stacked inputs */
    }
}


@keyframes pulse {
  0%, 100% {
    transform: scale(1); /* Original size */
  }
  50% {
    transform: scale(1.15);
  }
}
    
</style>
<div class="background-layer" id="layer1"></div>
<div class="background-layer" id="layer2"></div>

<!-- <div class="starting-page-container">
    <div class="search-container">
        <div class="input-section destination">
            <input type="text" id="city-search" placeholder="Where can we take you?" class="search-field">
            <label for="city-search" class="search-label">DESTINATION</label>
        </div>
        <div class="input-section date-range">
            <input type="text" id="date-input" placeholder="Date" class="search-field">
            <label for="date-input" class="search-label">1 NIGHT</label>
        </div>
        <button id="find-hotel-btn" class="search-btn">Find Hotels</button>
    </div>
</div> -->
<div class="starting-page-container">
    <div class="input-section">
        <h2>LOCATION</h2>
        <input type="text" id="city-search" placeholder="Start typing a city name...">
        <ul id="city-results" style="display: none;"></ul>
    </div>

    <div class="input-section">
        <h2>DATE</h2>
        <input type="date" id="date-input">
    </div>
    
    <div class="input-section">
        <button id="submit-btn">Find Services</button>
    </div>
</div>

<div class="services-container text-center row">
    <h2 class="col-sm-5"> Our Services</h2>
    <div class="col-sm-6  justify-content-center">
        <div class="col-sm-4 service-item">
            <a href="{% url 'movies_home' %}">
                <!-- <img src="{% static 'movies.jpg' %}" alt="Movies" class="service-icon">
                 -->
                 <div class="service-icon">
                    <i class="fas fa-film"></i> 
                    <p>Movies</p>
                 </div>
            </a>
        </div>
        <div class="col-sm-4 service-item">
            <a href="{% url 'hotel_list' %}">
                <!-- <img src="{% static 'hotels.png' %}" alt="Hotels" class="service-icon">
                 -->
                 <div class="service-icon">
                    <i class="fas fa-hotel"></i> 
                    <p>Hotels</p>
                 </div>
            </a>
        </div>
        <div class="col-sm-4 service-item">
            <a href="{% url 'restraunt_list' %}">
                <!-- <img src="{% static 'restraunt.png' %}" alt="Restraunts" class="service-icon">
                 -->
                 <div class="service-icon">
                    <i class="fas fa-utensils"></i> 
                    <p >Restraunts</p>
                 </div>
            </a>
        </div>
        <div class="col-sm-4 service-item">
            <a href="{% url 'search_flights' %}">
                <!-- <img src="{% static 'flights1.png' %}" alt="Flights" class="service-icon"> -->
                <div class="service-icon">
                    <i class="fas fa-plane"></i> 
                    <p>Flights</p>
                 </div>
            </a>
        </div>
    </div>
</div>
<div class="starting-page-container1">
    <a class="navbar-brand" href="{% url 'home' %}" style="background-color: white; border-radius: 10px; padding-left: 10px; box-shadow: #000; margin-bottom: 10px; margin-left: 0px;">BookNow
        <img src="{% static 'logo.png' %}" alt="Logo" style="width: 40px; height: 40px;">
    </a>
  <div class="container">
    <p class="description">The <strong class="animated-text">BookNow</strong> Now encompasses a simple and easy to use booking platform that allows the user to book everything they need, nothing less or more than a flight ticket or the latest blockbuster movies. First focus is on the cuisines not missing any delicacies near you. After that find your accommodation for upcoming trips. By integrating ease of use and variety of options into our web page, we make it easier for you to choose from several options and design your complete itinerary in simple clicks. Say goodbye to long tentative searches and headache-inducing booking procedures, your travel begins both comfortably and purposefully with Book Now. Traveling is a lot of fun, so why not start looking and book now your next thrilling escapade!</p>
  </div>
</div>
<script>

function getCurrentDate() {
    const date = new Date(); // Create a new Date object for the current date and time
    const month = date.getMonth() + 1; // getMonth() returns 0 for January, 11 for December, so add 1
    const day = date.getDate(); // getDate() returns the day of the month (1-31)
    const year = date.getFullYear(); // getFullYear() returns the full year (e.g., 2024)

    // Pad the month and day with a leading zero if they are less than 10
    const formattedMonth = month < 10 ? `0${month}` : month;
    const formattedDay = day < 10 ? `0${day}` : day;

    // Return the formatted date string
    return `${year}-${formattedMonth}-${formattedDay}`;
}

document.addEventListener('DOMContentLoaded', function() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;

            fetch(`https://api.opencagedata.com/geocode/v1/json?q=${latitude}+${longitude}&key=50dcbc16daaa45979838ae0e2fe46139`)
            .then(response => response.json())
            .then(data => {
                const components = data.results[0].components;
                const city = components.city || components.town || components.village;
                const state = components.state;

                document.cookie = "city=" + city + "; max-age=3153600; path=/";  // Expires in 1 year
                document.cookie = "state=" + state + "; max-age=3153600; path=/";  // Expires in 1 year
                document.getElementById('city-search').value = `${city}, ${state}`; 
                document.getElementById('date-input').value = getCurrentDate(); 
                fetch('/save-selection/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                        'X-CSRFToken': '{{ csrf_token }}' 
                    },
                    body: `city_name=${city}, ${state}&visit_date=${getCurrentDate()}`
                })
                .then(response => response.json())  
            })
            .catch(error => console.error('Error in fetching location details:', error));
        }, function(error) {
            console.error('Error getting location:', error);
        });
    } else {
        console.log("Geolocation is not supported by this browser.");
    }
});

document.getElementById('city-search').addEventListener('input', function() {
    const value = this.value;
    fetch(`/search-cities/?term=${value}`)
        .then(response => response.json())
        .then(data => {
            const ul = document.getElementById('city-results');
            if (data.length > 0) {
                ul.innerHTML = '';  
                data.slice(0, 5).forEach(city => {  // Limit to 5 results
                    const li = document.createElement('li');
                    li.textContent = `${city.city_name}, ${city.state_name}`;
                    ul.appendChild(li);
                    li.onclick = function() {
                        document.getElementById('city-search').value = this.textContent;
                        ul.style.display = 'none'; 
                    };
                });
                ul.style.display = 'block';  
            } else {
                ul.style.display = 'none'; 
            }
        });
});
document.getElementById('submit-btn').addEventListener('click', function() {
    const city = document.getElementById('city-search').value;
    const date = document.getElementById('date-input').value;
    fetch('/save-selection/', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
            'X-CSRFToken': '{{ csrf_token }}' 
        },
        body: `city_name=${city}&visit_date=${date}`
    })
    .then(response => response.json())
    .then(data => {
        if (data.status === 'success') {
            window.location.href = data.redirect_url;
        } else {
            alert('Failed to save selection.');
        }
    });
});
        document.addEventListener('DOMContentLoaded', function() {
            const images = [
            '{% static "movies_c.png" %}',
            '{% static "Flights_c.jpg" %}',
            '{% static "Hotels_c.jpg" %}',
            '{% static "Restaurants_c.jpg" %}',
            ];
            let currentIndex = 0;
            let visibleLayer = 1;
        
            images.forEach(image => {
                const img = new Image();
                img.src = image;
            });
        
            function changeBackground() {
                document.body.style.backgroundImage = 'none';
                const nextLayer = visibleLayer === 1 ? 2 : 1;
                const nextLayerEl = document.getElementById(`layer${nextLayer}`);
                const currentLayerEl = document.getElementById(`layer${visibleLayer}`);
        
                nextLayerEl.style.backgroundImage = `url("${images[currentIndex]}")`;
                nextLayerEl.style.opacity = 1;
                currentLayerEl.style.opacity = 0;
        
                visibleLayer = nextLayer;
                currentIndex = (currentIndex + 1) % images.length;
            }
        
            setInterval(changeBackground, 5000);
            changeBackground(); 
        });
</script> 
{% endblock %}
