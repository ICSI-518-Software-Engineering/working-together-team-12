{% extends 'base.html' %}
{% load static %}
{% block content %}
<div id="flights_home">
    <div class="flight-search-container" style="margin-top: 10px;">
        <h1 class="title">Search for Flights</h1>
        <form action="{% url 'search_flights' %}" method="post" class="flight-search-form">
            {% csrf_token %}
            <div class="route-inputs d-flex align-items-center justify-content-between">
                <input type="text" id="origin" name="origin" placeholder="Origin" class="form-control" style="max-width: 300px;">
                <ul id="origin-results" style="display: none;" class="results-list list-group"></ul> 

                <span class="swap-icon fa fa-exchange-alt" onclick="swapValues();"></span>
                <input type="text" id="destination" name="destination" placeholder="Destination" class="form-control" style="max-width: 300px;">
                
                <ul id="destination-results" style="display:none;"class="results-list list-group"></ul> 
                
                <input type="date" id="departure_date" name="departure_date" class="form-control" style="margin-left: 6px;margin-right: 3px;">
                <select id="class_type" name="class_type" class="form-control" style="margin-left: 3px;margin-right: 3px;">
                    <option value="ECO">Economy</option>
                    <option value="BUS">Business</option>
                    <option value="PEC">Premium Economy</option>
                    <option value="FST">First Class</option>
                </select>
                <div class="input-group">
                    <label for="sort_order" style="font-size: 15px; font-weight: bold; font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;">Sort by:</label>    
                    <select id="sort_order" name="sort_order">
                        <option value="PRICE">Price</option>
                        <option value="DEPARTTIME">Departure Time</option>
                        <option value="ARRIVETIME">Arrival Time</option>
                        <option value="TRAVELTIME">Duration</option>
                    </select>
                </div>
            </div>
            <button type="submit" class="search-btn" style="margin-left: 350px; margin-top: 20px;">Search</button>
        </form>
    </div>
    <div class="flight-company-container mt-4">
        <h2 class="text-center mb-4">Search by airlines</h2>
        <div class="row">
            <div class="col-sm-6 col-md-4 col-lg-3 mb-3" >
                <div class="flight-company-card">
                    <img src="{% static 'air_asia.png' %}" alt="Airline 1" class="img-fluid">
                </div>
            </div>
            <div class="col-sm-6 col-md-4 col-lg-3 mb-3">       
                <div class="flight-company-card">
                    <img src="{% static 'american.png' %}" alt="Airline 2" class="img-fluid">
                </div>
            </div>
            <div class="col-sm-6 col-md-4 col-lg-3 mb-3">
                <div class="flight-company-card">
                    <img src="{% static 'british.png' %}" alt="Airline 3" class="img-fluid">
                </div>
            </div>
            <div class="col-sm-6 col-md-4 col-lg-3 mb-3">
                <div class="flight-company-card">
                    <img src="{% static 'qatar.png' %}" alt="Airline 4" class="img-fluid">
                </div>
            </div>
        </div>
    </div>
</div>




<style>
    #origin-results {
        position: absolute;
        width: 217px;
        top: 40px;
        left: 0;
        right: 0;
        background: white;
        border: 1px solid #ddd;
        border-top: none;
        border-radius: 5px;
        list-style: none;
        padding-left: 0;
        max-height: 150px;
        overflow-y: auto;
        z-index: 100;
    }

    #destination-results {
        position: absolute;
        width: 217px;
        top: 40px;
        left: 325px;
        right: 0;
        background: white;
        border: 1px solid #ddd;
        border-top: none;
        border-radius: 5px;
        list-style: none;
        padding-left: 0;
        max-height: 150px;
        overflow-y: auto;
        z-index: 100;
    }

    #origin-results li, #destination-results li {
        padding: 10px;
        cursor: pointer;
    }

    #origin-results li:hover, #destination-results li:hover {
        background-color: #f2f2f2;
    }

    #origin-results {
        padding: 10px;
        border-radius: 20px;
        border: 1px solid #ced4da;
        background-color: rgba(255,255,255,0.7);
        margin-right: 10px; 
    }

#flights_home {
    background-image: url("/static/Flights_c.jpg");
    height: 100vh; 
    width: 100%;
    background-size: cover;
    background-position: center;

}
.flight-search-container {
    max-width: 1200px;
    margin: auto;
    padding: 20px;
    background-color: #f3f3f3;
    border-radius: 8px;
}

.flight-search-form .route-inputs {
    position: relative;
    display: flex;
    gap: 0px; 
}

.flight-search-form .route-inputs .form-control,
.flight-search-form .route-inputs .swap-icon {
    margin: 0; 
}

.flight-search-form .route-inputs .form-control {
    flex: 1;
    margin-right: -1px;
}

.flight-search-form .route-inputs .swap-icon {
    cursor: pointer;
    color: #007bff; 
    /* position: absolute;  */
    background-color: #f3f3f3; 
    border: none; 
    z-index: 1;
}

.search-btn {
    width: 40%;
    background-color: #007bff;
    color: white;
    padding: 10px 0;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.flight-search-form .route-inputs input[type="text"] {
    flex: none; 
    width: calc(50% - 20px); /* Adjust width, subtracting swap icon's width */
}

.flight-search-form .route-inputs input[type="date"],
.flight-search-form .route-inputs select {
    flex: none;
    width: auto; 
}

.swap-icon {
    margin: 0 10px; 
    cursor: pointer;
    color: #007bff;
    position: relative; 
    top: 1px;
}
.flight-company-container {
    padding: 20px;
    background-color: white;
    border-radius: 8px;
    margin: 0 20px ;
}

.flight-company-card {
    border: 1px solid #dee2e6;
    border-radius: 8px;
    overflow: hidden; 
    background-color: white;
    padding: 10px; /* Space around the image */
    display: flex; /* Center the image horizontally */
    justify-content: center; /* Center the image horizontally */
    align-items: center; /* Center the image vertically */
}

.flight-company-card img {
    max-width: 200px;
    height: 100px; 
    transition: transform 0.5s ease, max-width 0.5s ease, height 0.5s ease;
}
.flight-company-card img:hover {
    max-width: 200px;
    height: 100px; 
    transform: scale(1.3);
}

</style>

<script>
    document.getElementById('origin').addEventListener('input', function() {
    const value = this.value;
    fetch(`/search-airports/?term=${value}`)
        .then(response => response.json())
        .then(data => {
            const ul = document.getElementById('origin-results');
            if (data.length > 0) {
                ul.innerHTML = '';  
                data.slice(0, 5).forEach(city => {  // Limit to 5 results
                    const li = document.createElement('li');
                    li.textContent = `${city.locid}`;
                    ul.appendChild(li);
                    li.onclick = function() {
                        document.getElementById('origin').value = this.textContent;
                        ul.style.display = 'none'; 
                    };
                });
                ul.style.display = 'block';  
            } else {
                ul.style.display = 'none'; 
            }
        });
});

document.getElementById('destination').addEventListener('input', function() {
    const value = this.value;
    fetch(`/search-airports/?term=${value}`)
        .then(response => response.json())
        .then(data => {
            const ul = document.getElementById('destination-results');
            if (data.length > 0) {
                ul.innerHTML = '';  
                data.slice(0, 5).forEach(city => {  // Limit to 5 results
                    const li = document.createElement('li');
                    li.textContent = `${city.locid}`;
                    ul.appendChild(li);
                    li.onclick = function() {
                        document.getElementById('destination').value = this.textContent;
                        ul.style.display = 'none'; 
                    };
                });
                ul.style.display = 'block';  
            } else {
                ul.style.display = 'none'; 
            }
        });
});
</script>
{% endblock %}

{% block extra_js %}
<script>
function swapValues() {
    var origin = document.getElementById('origin');
    var destination = document.getElementById('destination');
    var temp = origin.value;
    origin.value = destination.value;
    destination.value = temp;
}

</script>
{% endblock %}
